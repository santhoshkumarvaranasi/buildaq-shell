import{b as f}from"./chunk-ABQXFKWW.js";import{a as g}from"./chunk-PFR7XYIG.js";import{a as u}from"./chunk-2NFLSA4Y.js";import{bootstrapApplication as K}from"@angular/platform-browser";import{provideBrowserGlobalErrorListeners as D,provideZonelessChangeDetection as O}from"@angular/core";import{provideRouter as P}from"@angular/router";import{provideHttpClient as L,withInterceptors as R}from"@angular/common/http";import{provideAnimations as T}from"@angular/platform-browser/animations";var E=!0,w=E?"https://schools.buildaq.com/remoteEntry.js":"http://localhost:3000/assets/remoteEntry.json",h=[{path:"",redirectTo:"/dashboard",pathMatch:"full"},{path:"login",loadComponent:()=>import("./chunk-HUG4TQF2.js").then(i=>i.LoginComponent)},{path:"dashboard",loadComponent:()=>import("./chunk-3SC7YAMU.js").then(i=>i.DashboardComponent)},{path:"schools",loadChildren:()=>f({remoteEntry:w,exposedModule:"./SchoolsModule"}).then(i=>i.SchoolsModule).catch(i=>(console.error("Failed to load schools remote with Native Federation:",i),Promise.resolve([{path:"",loadComponent:()=>import("./chunk-5ZCYKZDO.js").then(t=>t.RemoteFallbackComponent)}])))},{path:"**",redirectTo:"/dashboard"}];import{provideClientHydration as I,withEventReplay as A}from"@angular/platform-browser";var d={production:!1,apiUrl:"http://localhost:3000",multiTenant:{defaultTenant:"demo.buildaq.com"}};var b=(i,t)=>{try{let n=localStorage.getItem("auth_token"),o=localStorage.getItem("tenant_id")||d.multiTenant?.defaultTenant,r=i.headers;n&&(r=r.set("Authorization",`Bearer ${n}`)),o&&(r=r.set("X-Tenant-ID",o));let x=/^https?:\/\//i.test(i.url)?i.url:`${d.apiUrl.replace(/\/$/,"")}/${i.url.replace(/^\//,"")}`,S=i.clone({headers:r,url:x});return t(S)}catch{return t(i)}};var _={providers:[D(),O(),P(h),I(A()),L(R([b])),T()]};import{signal as G}from"@angular/core";import{RouterOutlet as j,RouterLink as z}from"@angular/router";import{CommonModule as $}from"@angular/common";import{Subject as H,takeUntil as B}from"rxjs";import*as e from"@angular/core";import*as l from"@angular/core";import*as v from"@angular/common/http";import*as C from"@angular/router";var s=class i{constructor(t,n){this.http=t;this.router=n}remotes=new Map;async loadRemotes(){try{let t=await this.http.get("http://localhost:3000/assets/remotes.json").toPromise();if(t){for(let[n,o]of Object.entries(t))if(o.enabled){let r=this.getEnvironmentAwareConfig(o);await this.loadRemote(n,r)}}}catch(t){console.error("Failed to load remotes registry:",t)}}getEnvironmentAwareConfig(t){if(window.location.hostname==="localhost"){let n=u({},t);return t.url.includes("schools.buildaq.com")&&(n.url="http://localhost:3000/assets/remoteEntry.js"),n}return t}async loadRemote(t,n){try{console.log(`Loading remote: ${t} from ${n.url}`),this.remotes.set(t,{config:n}),console.log(`Successfully configured remote: ${t}`)}catch(o){console.error(`Failed to load remote ${t}:`,o),this.handleRemoteLoadError(t,o)}}handleRemoteLoadError(t,n){console.error(`Remote ${t} failed to load:`,n)}getRemote(t){return this.remotes.get(t)}getLoadedRemotes(){return Array.from(this.remotes.keys())}static \u0275fac=function(n){return new(n||i)(l.\u0275\u0275inject(v.HttpClient),l.\u0275\u0275inject(C.Router))};static \u0275prov=l.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"})};import*as M from"@angular/router";import*as k from"@angular/common";function N(i,t){if(i&1){let n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",34),e.\u0275\u0275text(1),e.\u0275\u0275elementStart(2,"button",35),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);let r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.logout())}),e.\u0275\u0275text(3,"Logout"),e.\u0275\u0275elementEnd()()}if(i&2){let n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" Welcome, ",n.userContext.name,"! ")}}function U(i,t){if(i&1){let n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"button",36),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);let r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.login())}),e.\u0275\u0275text(2,"Login"),e.\u0275\u0275elementEnd()()}}var c=class i{constructor(t,n,o){this.authService=t;this.remoteLoader=n;this.router=o}destroy$=new H;userContext=null;isMobileMenuOpen=!1;ngOnInit(){this.authService.userContext$.pipe(B(this.destroy$)).subscribe(t=>{this.userContext=t,t&&this.loadRemoteApplications()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}async login(){this.router.navigate(["/login"])}async logout(){try{await this.authService.logout(),this.router.navigate(["/login"])}catch(t){console.error("Logout failed:",t)}}toggleMobileMenu(){this.isMobileMenuOpen=!this.isMobileMenuOpen}closeMobileMenu(){this.isMobileMenuOpen=!1}handleEscapeKey(){this.closeMobileMenu()}async loadRemoteApplications(){try{await this.remoteLoader.loadRemotes()}catch(t){console.error("Failed to load remote applications:",t)}}static \u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(g),e.\u0275\u0275directiveInject(s),e.\u0275\u0275directiveInject(M.Router))};static \u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["app-layout"]],hostBindings:function(n,o){n&1&&e.\u0275\u0275listener("keydown.escape",function(){return o.handleEscapeKey()},e.\u0275\u0275resolveDocument)},decls:109,vars:6,consts:[[1,"layout"],[1,"header"],[1,"header-container"],[1,"logo"],[1,"mobile-menu-toggle",3,"click"],[1,"hamburger-line"],[1,"logo-text"],[1,"header-actions"],["class","user-info",4,"ngIf"],[4,"ngIf"],[1,"mobile-overlay",3,"click"],[1,"sidebar"],[1,"nav-items"],["routerLink","/dashboard",1,"nav-item",3,"click"],[1,"icon"],[1,"nav-section"],["routerLink","/schools",1,"nav-item",3,"click"],[1,"nav-group"],[1,"nav-group-title"],["routerLink","/schools/admissions",1,"nav-item",3,"click"],["routerLink","/schools/students",1,"nav-item",3,"click"],["routerLink","/schools/teachers",1,"nav-item",3,"click"],["routerLink","/schools/attendance",1,"nav-item",3,"click"],["routerLink","/schools/timetable",1,"nav-item",3,"click"],["routerLink","/schools/exams",1,"nav-item",3,"click"],["routerLink","/schools/behavior",1,"nav-item",3,"click"],["routerLink","/schools/announcements",1,"nav-item",3,"click"],["routerLink","/schools/library",1,"nav-item",3,"click"],["routerLink","/schools/transport",1,"nav-item",3,"click"],["routerLink","/schools/fees",1,"nav-item",3,"click"],["routerLink","/schools/fees/receipts",1,"nav-item",3,"click"],["routerLink","/schools/fees/reminders",1,"nav-item",3,"click"],["routerLink","/schools/fees/discounts",1,"nav-item",3,"click"],[1,"content"],[1,"user-info"],[1,"btn-logout",3,"click"],[1,"btn-login",3,"click"]],template:function(n,o){n&1&&(e.\u0275\u0275elementStart(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"button",4),e.\u0275\u0275listener("click",function(){return o.toggleMobileMenu()}),e.\u0275\u0275element(5,"span",5)(6,"span",5)(7,"span",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"span",6),e.\u0275\u0275text(9,"BuildAQ Shell"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"div",7),e.\u0275\u0275template(11,N,4,1,"div",8)(12,U,3,0,"div",9),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(13,"div",10),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"nav",11)(15,"div",12)(16,"a",13),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(17,"span",14),e.\u0275\u0275text(18,"\u{1F3E0}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"span"),e.\u0275\u0275text(20,"Dashboard"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(21,"div",15),e.\u0275\u0275text(22,"Remote Apps"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"a",16),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(24,"span",14),e.\u0275\u0275text(25,"\u{1F3EB}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"span"),e.\u0275\u0275text(27,"School Management"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(28,"div",17)(29,"div",18),e.\u0275\u0275text(30,"Admissions"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(31,"a",19),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(32,"span",14),e.\u0275\u0275text(33,"\u{1F4E5}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(34,"span"),e.\u0275\u0275text(35,"Admissions"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(36,"div",17)(37,"div",18),e.\u0275\u0275text(38,"Academics"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(39,"a",20),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(40,"span",14),e.\u0275\u0275text(41,"\u{1F393}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(42,"span"),e.\u0275\u0275text(43,"Students"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(44,"a",21),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(45,"span",14),e.\u0275\u0275text(46,"\u{1F469}\u200D\u{1F3EB}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(47,"span"),e.\u0275\u0275text(48,"Teachers"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(49,"a",22),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(50,"span",14),e.\u0275\u0275text(51,"\u{1F552}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"span"),e.\u0275\u0275text(53,"Attendance"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(54,"a",23),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(55,"span",14),e.\u0275\u0275text(56,"\u{1F4C5}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(57,"span"),e.\u0275\u0275text(58,"Timetable"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(59,"a",24),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(60,"span",14),e.\u0275\u0275text(61,"\u{1F4DD}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(62,"span"),e.\u0275\u0275text(63,"Exams"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(64,"a",25),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(65,"span",14),e.\u0275\u0275text(66,"\u{1F6A6}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(67,"span"),e.\u0275\u0275text(68,"Behavior"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(69,"a",26),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(70,"span",14),e.\u0275\u0275text(71,"\u{1F4E3}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(72,"span"),e.\u0275\u0275text(73,"Announcements"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(74,"a",27),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(75,"span",14),e.\u0275\u0275text(76,"\u{1F4DA}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(77,"span"),e.\u0275\u0275text(78,"Library"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(79,"a",28),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(80,"span",14),e.\u0275\u0275text(81,"\u{1F68C}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(82,"span"),e.\u0275\u0275text(83,"Transport"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(84,"div",17)(85,"div",18),e.\u0275\u0275text(86,"Finance"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(87,"a",29),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(88,"span",14),e.\u0275\u0275text(89,"\u{1F4B3}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(90,"span"),e.\u0275\u0275text(91,"Fees"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(92,"a",30),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(93,"span",14),e.\u0275\u0275text(94,"\u{1F9FE}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(95,"span"),e.\u0275\u0275text(96,"Receipts"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(97,"a",31),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(98,"span",14),e.\u0275\u0275text(99,"\u{1F514}"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(100,"span"),e.\u0275\u0275text(101,"Reminders"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(102,"a",32),e.\u0275\u0275listener("click",function(){return o.closeMobileMenu()}),e.\u0275\u0275elementStart(103,"span",14),e.\u0275\u0275text(104,"\u{1F3F7}\uFE0F"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(105,"span"),e.\u0275\u0275text(106,"Discounts"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(107,"main",33),e.\u0275\u0275element(108,"router-outlet"),e.\u0275\u0275elementEnd()()),n&2&&(e.\u0275\u0275advance(11),e.\u0275\u0275property("ngIf",o.userContext),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",!o.userContext),e.\u0275\u0275advance(),e.\u0275\u0275classProp("active",o.isMobileMenuOpen),e.\u0275\u0275advance(),e.\u0275\u0275classProp("open",o.isMobileMenuOpen))},dependencies:[$,k.NgIf,j,z],styles:[".layout[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh}.header[_ngcontent-%COMP%]{background:#fff;border-bottom:1px solid #e4e9f0;z-index:1000;position:fixed;top:0;left:0;right:0;height:60px}.header-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:0 1rem;height:100%;max-width:100%}.logo[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:1.25rem;font-weight:600;color:#2a2a2a}.logo-text[_ngcontent-%COMP%]{margin-left:.5rem}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;font-size:.875rem;color:#666}.btn-logout[_ngcontent-%COMP%], .btn-login[_ngcontent-%COMP%]{background:#007bff;color:#fff;border:none;padding:.5rem 1rem;border-radius:4px;cursor:pointer;font-size:.875rem}.btn-logout[_ngcontent-%COMP%]:hover, .btn-login[_ngcontent-%COMP%]:hover{background:#0056b3}.sidebar[_ngcontent-%COMP%]{position:fixed;left:0;top:60px;bottom:0;width:250px;background-color:#f8f9fa;border-right:1px solid #e4e9f0;padding:1rem 0;overflow-y:auto}.nav-items[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.nav-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.65rem 1rem;color:#2f3441;text-decoration:none;border-radius:8px;margin:0 .75rem;transition:background-color .2s,color .2s}.nav-item[_ngcontent-%COMP%]:hover{background-color:#e5efff;color:#0b63f6}.nav-section[_ngcontent-%COMP%]{padding:.25rem 1rem;font-size:.75rem;font-weight:700;letter-spacing:.04em;text-transform:uppercase;color:#6c757d}.nav-group[_ngcontent-%COMP%]{padding:.25rem .75rem .75rem;border-top:1px solid #e4e9f0}.nav-group-title[_ngcontent-%COMP%]{padding:.35rem .25rem;font-size:.78rem;font-weight:800;color:#4b5563;text-transform:uppercase;letter-spacing:.05em}.icon[_ngcontent-%COMP%]{width:1.4rem;text-align:center;font-size:1rem}.content[_ngcontent-%COMP%]{margin-left:250px;margin-top:60px;padding:2rem;min-height:calc(100vh - 60px);background-color:#f8f9fa}@media (max-width: 768px){.header-container[_ngcontent-%COMP%]{padding:0 1rem}.logo-text[_ngcontent-%COMP%]{font-size:1rem}.sidebar[_ngcontent-%COMP%]{transform:translate(-100%);transition:transform .3s ease;z-index:1001}.sidebar.open[_ngcontent-%COMP%]{transform:translate(0)}.content[_ngcontent-%COMP%]{margin-left:0;padding:1rem}.nav-item[_ngcontent-%COMP%]{padding:1rem;font-size:.9rem}.user-info[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem;align-items:flex-end;font-size:.8rem}}.mobile-menu-toggle[_ngcontent-%COMP%]{display:none;background:none;border:none;cursor:pointer;padding:.25rem;border-radius:4px;flex-direction:column;justify-content:space-around;width:32px;height:32px;transition:all .3s ease}.mobile-menu-toggle[_ngcontent-%COMP%]:hover{background-color:#0000000d}.hamburger-line[_ngcontent-%COMP%]{display:block;height:3px;width:20px;background-color:#333;border-radius:1px;transition:all .3s ease}.mobile-overlay[_ngcontent-%COMP%]{display:none;position:fixed;top:60px;left:0;width:100%;height:calc(100vh - 60px);background:#00000080;z-index:1000;opacity:0;transition:opacity .3s ease}.mobile-overlay.active[_ngcontent-%COMP%]{display:block;opacity:1}@media (max-width: 768px){.mobile-menu-toggle[_ngcontent-%COMP%]{display:flex}.sidebar[_ngcontent-%COMP%]{transform:translate(-100%);transition:transform .3s ease;z-index:1001;box-shadow:2px 0 5px #0000001a}.sidebar.open[_ngcontent-%COMP%]{transform:translate(0)}}.sidebar[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], [_nghost-%COMP%]     .content *, [_nghost-%COMP%]     body{scrollbar-width:thin;scrollbar-color:#b7c5ff #f2f5ff}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar, .content[_ngcontent-%COMP%]::-webkit-scrollbar, [_nghost-%COMP%]     .content *::-webkit-scrollbar, [_nghost-%COMP%]     body::-webkit-scrollbar{width:8px;height:8px}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar-track, .content[_ngcontent-%COMP%]::-webkit-scrollbar-track, [_nghost-%COMP%]     .content *::-webkit-scrollbar-track, [_nghost-%COMP%]     body::-webkit-scrollbar-track{background:#f2f5ff}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, [_nghost-%COMP%]     .content *::-webkit-scrollbar-thumb, [_nghost-%COMP%]     body::-webkit-scrollbar-thumb{background:#b7c5ff;border-radius:999px;border:2px solid #f2f5ff}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, [_nghost-%COMP%]     .content *::-webkit-scrollbar-thumb:hover, [_nghost-%COMP%]     body::-webkit-scrollbar-thumb:hover{background:#8da6ff}"]})};import*as a from"@angular/core";import*as y from"@angular/core";var m=class i{es=null;constructor(){try{if(typeof window<"u"&&window.location&&window.location.hostname==="localhost"){let t="http://localhost:3000/assets/remote-events";this.es=new EventSource(t),this.es.addEventListener("reload",n=>{try{console.log("[remote-reload] remote rebuild detected, reloading shell",n&&n.data),window.location.reload()}catch{}}),this.es.addEventListener("error",n=>{console.warn("[remote-reload] SSE error",n)})}}catch{}}close(){try{this.es&&this.es.close()}catch{}}static \u0275fac=function(n){return new(n||i)};static \u0275prov=y.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"})};var p=class i{title=G("buildaq-shell");constructor(t){}static \u0275fac=function(n){return new(n||i)(a.\u0275\u0275directiveInject(m))};static \u0275cmp=a.\u0275\u0275defineComponent({type:i,selectors:[["app-root"]],decls:1,vars:0,template:function(n,o){n&1&&a.\u0275\u0275element(0,"app-layout")},dependencies:[c],encapsulation:2})};K(p,_).catch(i=>console.error(i));
