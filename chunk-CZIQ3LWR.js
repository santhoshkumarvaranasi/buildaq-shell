import{a as c,b as f}from"./chunk-2NFLSA4Y.js";var N="__NATIVE_FEDERATION__",R=globalThis;R[N]??={externals:new Map,remoteNamesToRemote:new Map,baseUrlToRemoteNames:new Map};var d=R[N],b=d.externals;function I(e){return`${e.packageName}@${e.version}`}function _(e){let t=I(e);return b.get(t)}function x(e,t){let o=I(e);b.set(o,t)}function T(e,t){return{imports:c(c({},e.imports),t.imports),scopes:c(c({},e.scopes),t.scopes)}}var M=d.remoteNamesToRemote,p=d.baseUrlToRemoteNames;function O(e,t){M.set(e,t),p.set(t.baseUrl,e)}function P(e){return p.get(e)}function v(e){return p.has(e)}function j(e){return M.get(e)}var y=globalThis,l;function A(){if(l===void 0&&(l=null,y.trustedTypes))try{l=y.trustedTypes.createPolicy("native-federation",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return l}function w(e){return A()?.createScript(e)??e}function F(e){document.head.appendChild(Object.assign(document.createElement("script"),{type:w("importmap-shim"),textContent:w(JSON.stringify(e))}))}function g(e){let t=e.split("/");return t.pop(),t.join("/")}function m(e,t){for(;e.endsWith("/");)e=e.substring(0,e.length-1);return t.startsWith("./")&&(t=t.substring(2,t.length)),`${e}/${t}`}var S=(function(e){return e.COMPLETED="federation-rebuild-complete",e.ERROR="federation-rebuild-error",e.CANCELLED="federation-rebuild-cancelled",e})(S||{});function D(e){let t=new EventSource(e);t.onmessage=function(o){JSON.parse(o.data).type===S.COMPLETED&&(console.log("[Federation] Rebuild completed, reloading..."),window.location.reload())},t.onerror=function(o){console.warn("[Federation] SSE connection error:",o)}}async function X(e={},t){let o=t?.cacheTag?`?t=${t.cacheTag}`:"",n=typeof e=="string"?await L(e+o):e,r=await C(`./remoteEntry.json${o}`),s=await B(r),a=await K(n,c({throwIfRemoteNotFound:!1},t)),i=T(s,a);return F(i),i}async function L(e){return await fetch(e).then(o=>o.json())}function U(e,t){if(!t)return e;let o=e.includes("?")?"&":"?";return`${e}${o}t=${t}`}function W(e,t,o,n){let r=`Error loading remote entry for ${e} from file ${t}`;if(o.throwIfRemoteNotFound)throw new Error(r);return console.error(r),console.error(n),null}async function K(e,t={throwIfRemoteNotFound:!1}){let o=Object.entries(e).map(async([s,a])=>{try{let i=U(a,t.cacheTag);return await k(i,s)}catch(i){return W(s,a,t,i)}});return(await Promise.all(o)).reduce((s,a)=>a?T(s,a):s,{imports:{},scopes:{}})}async function k(e,t){let o=g(e),n=await C(e);t||(t=n.name),n.buildNotificationsEndpoint&&D(o+n.buildNotificationsEndpoint);let r=V(n,t,o);return O(t,f(c({},n),{baseUrl:o})),r}function V(e,t,o){let n=q(e,t,o),r=z(e,o);return{imports:n,scopes:r}}async function C(e){return await fetch(e).then(o=>o.json())}function z(e,t){let o={},n={};for(let r of e.shared){let s=_(r)??m(t,r.outFileName);x(r,s),n[r.packageName]=s}return o[t+"/"]=n,o}function q(e,t,o){let n={};for(let r of e.exposes){let s=m(t,r.key),a=m(o,r.outFileName);n[s]=a}return n}async function B(e,t="./"){let o=e.shared.reduce((n,r)=>f(c({},n),{[r.packageName]:t+r.outFileName}),{});for(let n of e.shared)x(n,t+n.outFileName);return{imports:o,scopes:{}}}async function Y(e,t){let o=Q(e,t);await G(o);let n=J(o),r=j(n),s=o.fallback,a=r?"":"unknown remote "+n;if(!r&&!s)throw new Error(a);if(!r)return E(a),Promise.resolve(s);let i=r.exposes.find(u=>u.key===o.exposedModule),h=i?"":`Unknown exposed module ${o.exposedModule} in remote ${n}`;if(!i&&!s)throw new Error(h);if(!i)return E(h),Promise.resolve(s);let $=m(r.baseUrl,i.outFileName);try{return H($)}catch(u){if(s)return console.error("error loading remote module",u),s;throw u}}function H(e){return typeof importShim<"u"?importShim(e):import(e)}function J(e){let t;if(e.remoteName)t=e.remoteName;else if(e.remoteEntry){let o=g(e.remoteEntry);t=P(o)}else throw new Error("unexpected arguments: Please pass remoteName or remoteEntry");if(!t)throw new Error("unknown remoteName "+t);return t}async function G(e){if(e.remoteEntry&&!v(g(e.remoteEntry))){let t=await k(e.remoteEntry);F(t)}}function Q(e,t){let o;if(typeof e=="string"&&t)o={remoteName:e,exposedModule:t};else if(typeof e=="object"&&!t)o=e;else throw new Error("unexpected arguments: please pass options or a remoteName/exposedModule-pair");return o}function E(e){typeof window<"u"&&console.error(e)}export{X as a,Y as b};
