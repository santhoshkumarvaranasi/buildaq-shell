import{a as s}from"./chunk-PFR7XYIG.js";import"./chunk-2NFLSA4Y.js";import{CommonModule as g}from"@angular/common";import{FormsModule as u}from"@angular/forms";import*as e from"@angular/core";import*as d from"@angular/router";import*as p from"@angular/common";import*as o from"@angular/forms";function c(l,i){if(l&1&&(e.\u0275\u0275elementStart(0,"div",12),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),l&2){let a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(a.error)}}var m=class l{constructor(i,a,n){this.auth=i;this.router=a;this.route=n;try{this.domain=(window.location.hostname||"").toLowerCase();let t=new URLSearchParams(window.location.search||"").get("tenant")||localStorage.getItem("tenant_override")||"";t?this.domain=t.toLowerCase():(this.domain==="localhost"||this.domain==="127.0.0.1")&&(this.domain="demo.buildaq.com")}catch{this.domain=""}}username="";password="";domain="";error=null;isValidDomain(i){return i?i==="localhost"||i==="127.0.0.1"?!0:/^(?=.{3,255}$)([a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)(\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)+$/i.test(i):!1}async submit(){try{if(this.error=null,!this.isValidDomain(this.domain)){this.error="Unable to infer a valid tenant domain from the host. Please access the app using your tenant subdomain.";return}await this.auth.login(this.username,this.password,this.domain||void 0);let i=this.route.snapshot.queryParamMap.get("returnUrl")||"/";this.router.navigateByUrl(i)}catch(i){this.error=i?.message||"Login failed"}}static \u0275fac=function(a){return new(a||l)(e.\u0275\u0275directiveInject(s),e.\u0275\u0275directiveInject(d.Router),e.\u0275\u0275directiveInject(d.ActivatedRoute))};static \u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["app-login"]],decls:25,vars:6,consts:[[1,"login-page"],[1,"login-card"],[3,"ngSubmit"],["type","text","name","domain","placeholder","example.buildaq.com",3,"ngModelChange","ngModel"],["type","text","name","username","placeholder","username",3,"ngModelChange","ngModel"],["type","password","name","password","placeholder","password",3,"ngModelChange","ngModel"],[1,"small"],[1,"visually-hidden"],["type","hidden","name","domain",3,"ngModelChange","ngModel"],[1,"actions"],["type","submit"],["class","error",4,"ngIf"],[1,"error"]],template:function(a,n){a&1&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"h2"),e.\u0275\u0275text(3,"Sign in"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"form",2),e.\u0275\u0275listener("ngSubmit",function(){return n.submit()}),e.\u0275\u0275elementStart(5,"label"),e.\u0275\u0275text(6,"Domain"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"input",3),e.\u0275\u0275twoWayListener("ngModelChange",function(t){return e.\u0275\u0275twoWayBindingSet(n.domain,t)||(n.domain=t),t}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"label"),e.\u0275\u0275text(9,"Username"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"input",4),e.\u0275\u0275twoWayListener("ngModelChange",function(t){return e.\u0275\u0275twoWayBindingSet(n.username,t)||(n.username=t),t}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"label"),e.\u0275\u0275text(12,"Password"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"input",5),e.\u0275\u0275twoWayListener("ngModelChange",function(t){return e.\u0275\u0275twoWayBindingSet(n.password,t)||(n.password=t),t}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"p",6),e.\u0275\u0275text(15,"Signing into tenant inferred from this host: "),e.\u0275\u0275elementStart(16,"strong"),e.\u0275\u0275text(17),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(18,"label",7),e.\u0275\u0275text(19,"Domain (inferred)"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"input",8),e.\u0275\u0275twoWayListener("ngModelChange",function(t){return e.\u0275\u0275twoWayBindingSet(n.domain,t)||(n.domain=t),t}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"div",9)(22,"button",10),e.\u0275\u0275text(23,"Sign in"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(24,c,2,1,"div",11),e.\u0275\u0275elementEnd()()),a&2&&(e.\u0275\u0275advance(7),e.\u0275\u0275twoWayProperty("ngModel",n.domain),e.\u0275\u0275advance(3),e.\u0275\u0275twoWayProperty("ngModel",n.username),e.\u0275\u0275advance(3),e.\u0275\u0275twoWayProperty("ngModel",n.password),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(n.domain||"(none)"),e.\u0275\u0275advance(3),e.\u0275\u0275twoWayProperty("ngModel",n.domain),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",n.error))},dependencies:[g,p.NgIf,u,o.\u0275NgNoValidate,o.DefaultValueAccessor,o.NgControlStatus,o.NgControlStatusGroup,o.NgModel,o.NgForm],styles:[".login-page[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:70vh}.login-card[_ngcontent-%COMP%]{width:360px;padding:20px;border-radius:8px;background:#fff;box-shadow:0 6px 24px #00000014}.login-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 12px}.login-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:8px 10px;margin:8px 0;border:1px solid #ddd;border-radius:6px}.actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:12px}.error[_ngcontent-%COMP%]{color:#c00;margin-top:8px}"]})};export{m as LoginComponent};
