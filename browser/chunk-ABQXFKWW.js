import{a as c,b as m}from"./chunk-2NFLSA4Y.js";var w="__NATIVE_FEDERATION__",y=globalThis;y[w]??={externals:new Map,remoteNamesToRemote:new Map,baseUrlToRemoteNames:new Map};var p=y[w],E=p.externals;function N(e){return`${e.packageName}@${e.version}`}function O(e){let t=N(e);return E.get(t)}function I(e,t){let o=N(e);E.set(o,t)}function b(e,t){return{imports:c(c({},e.imports),t.imports),scopes:c(c({},e.scopes),t.scopes)}}var R=p.remoteNamesToRemote,d=p.baseUrlToRemoteNames;function _(e,t){R.set(e,t),d.set(t.baseUrl,e)}function S(e){return d.get(e)}function $(e){return d.has(e)}function P(e){return R.get(e)}function x(e){document.head.appendChild(Object.assign(document.createElement("script"),{type:"importmap-shim",innerHTML:JSON.stringify(e)}))}function g(e){let t=e.split("/");return t.pop(),t.join("/")}function f(e,t){for(;e.endsWith("/");)e=e.substring(0,e.length-1);return t.startsWith("./")&&(t=t.substring(2,t.length)),`${e}/${t}`}var T=(function(e){return e.COMPLETED="federation-rebuild-complete",e.ERROR="federation-rebuild-error",e})(T||{});function j(e){let t=new EventSource(e);t.onmessage=function(o){JSON.parse(o.data).type===T.COMPLETED&&(console.log("[Federation] Rebuild completed, reloading..."),window.location.reload())},t.onerror=function(o){console.warn("[Federation] SSE connection error:",o)}}async function z(e={},t){let o=t?.cacheTag?`?t=${t.cacheTag}`:"",n=typeof e=="string"?await v(e+o):e,r="./remoteEntry.json"+o,s=await F(r),i=await K(s),a=await C(n,c({throwIfRemoteNotFound:!1},t)),u=b(i,a);return x(u),u}async function v(e){return await fetch(e).then(t=>t.json())}async function C(e,t={throwIfRemoteNotFound:!1}){let o=Object.keys(e).map(async s=>{try{let i=e[s];if(t.cacheTag){let a=e[s].includes("?")?"&":"?";i+=`${a}t=${t.cacheTag}`}return await M(i,s)}catch{let a=`Error loading remote entry for ${s} from file ${e[s]}`;if(t.throwIfRemoteNotFound)throw new Error(a);return console.error(a),null}});return(await Promise.all(o)).reduce((s,i)=>i?b(s,i):s,{imports:{},scopes:{}})}async function M(e,t){let o=g(e),n=await F(e);t||(t=n.name),n.buildNotificationsEndpoint&&j(o+n.buildNotificationsEndpoint);let r=D(n,t,o);return _(t,m(c({},n),{baseUrl:o})),r}function D(e,t,o){let n=A(e,t,o),r=U(e,o);return{imports:n,scopes:r}}async function F(e){return await fetch(e).then(o=>o.json())}function U(e,t){let o={},n={};for(let r of e.shared){let s=O(r)??f(t,r.outFileName);I(r,s),n[r.packageName]=s}return o[t+"/"]=n,o}function A(e,t,o){let n={};for(let r of e.exposes){let s=f(t,r.key),i=f(o,r.outFileName);n[s]=i}return n}async function K(e,t="./"){let o=e.shared.reduce((n,r)=>m(c({},n),{[r.packageName]:t+r.outFileName}),{});for(let n of e.shared)I(n,t+n.outFileName);return{imports:o,scopes:{}}}async function B(e,t){let o=q(e,t);await L(o);let n=W(o),r=P(n),s=o.fallback,i=r?"":"unknown remote "+n;if(!r&&!s)throw new Error(i);if(!r)return h(i),Promise.resolve(s);let a=r.exposes.find(l=>l.key===o.exposedModule),u=a?"":`Unknown exposed module ${o.exposedModule} in remote ${n}`;if(!a&&!s)throw new Error(u);if(!a)return h(u),Promise.resolve(s);let k=f(r.baseUrl,a.outFileName);try{return V(k)}catch(l){if(s)return console.error("error loading remote module",l),s;throw l}}function V(e){return typeof importShim<"u"?importShim(e):import(e)}function W(e){let t;if(e.remoteName)t=e.remoteName;else if(e.remoteEntry){let o=g(e.remoteEntry);t=S(o)}else throw new Error("unexpcted arguments: Please pass remoteName or remoteEntry");if(!t)throw new Error("unknown remoteName "+t);return t}async function L(e){if(e.remoteEntry&&!$(g(e.remoteEntry))){let t=await M(e.remoteEntry);x(t)}}function q(e,t){let o;if(typeof e=="string"&&t)o={remoteName:e,exposedModule:t};else if(typeof e=="object"&&!t)o=e;else throw new Error("unexpected arguments: please pass options or a remoteName/exposedModule-pair");return o}function h(e){typeof window<"u"&&console.error(e)}export{z as a,B as b};
